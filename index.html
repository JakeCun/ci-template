<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Typing Trainer</title>
<style>
body {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  background: #111;
  color: #fff;
  font-family: monospace;
  user-select: none;
  margin: 0;
  padding: 0;
}

#current {
  border: 4px solid #fff;
  border-radius: 10px;
  padding: 2rem 4rem;
  font-size: 8rem;
  text-align: center;
  margin-bottom: 1rem;
  opacity: 1;
  transition: opacity 0.1s ease-in-out;
}

#stats {
  font-size: 1.2rem;
  color: #ccc;
  margin-bottom: 1rem;
}

#keyboard-vis {
  display: flex;
  flex-direction: column;
  margin-top: 30px;
  gap: 5px;
}

.row {
  display: flex;
  gap: 5px;
}

.row.homeRow {
  margin-left: 25px;
}

.row.bottomRow {
  margin-left: 50px;
}

.vis-key {
  position: relative;
  width: 45px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #222;
  border-radius: 5px;
  font-size: 16px;
  opacity: 0.5;
  transition: all 0.15s ease;
}

.vis-key.active.correct {
  background: lime;
  opacity: 1;
}

.vis-key.active.wrong {
  background: red;
  opacity: 1;
}

.vis-key.target {
  transform: scale(1.3);
  opacity: 1;
  z-index: 1;
  transition: transform 0.15s ease, opacity 0.15s ease;
}

/* Home row indicators for F and J keys */
.vis-key.indicator::after {
  content: '';
  position: absolute;
  width: 6px;
  height: 6px;
  background: white;
  border-radius: 50%;
  bottom: 5px;
}

#test-button {
  margin-top: 40px;
  background: #0f0;
  color: #111;
  font-size: 1.2rem;
  padding: 10px 25px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.2s ease;
}

#test-button:hover {
  background: #8f8;
}
</style>
</head>
<body>

<div id="current"></div>
<div id="stats">Press the correct key!</div>

<div id="keyboard-vis">
  <div class="row topRow" id="topRow"></div>
  <div class="row homeRow" id="homeRow"></div>
  <div class="row bottomRow" id="bottomRow"></div>
</div>

<button id="test-button" onclick="window.location.href='test.html'">Go to Typing Test</button>

<script>
const topKeys = ["q","w","e","r","t","y","u","i","o","p","[","]","\\"];
const homeKeys = ["a","s","d","f","g","h","j","k","l",";", "'"];
const bottomKeys = ["z","x","c","v","b","n","m",",",".","/"];

const allKeys = [...topKeys, ...homeKeys, ...bottomKeys];
const commonLetters = "etaoinshrdlcum".split("");

const statsData = {};
allKeys.forEach(k => statsData[k] = { correct:0, total:0 });

const currentBox = document.getElementById("current");

// Create keyboard visual
function createRow(rowId, keys) {
  const row = document.getElementById(rowId);
  keys.forEach(key => {
    const div = document.createElement("div");
    div.textContent = key.toUpperCase();
    div.id = `vis-${key}`;
    div.classList.add("vis-key");

    // Add indicator to F and J
    if(key === "f" || key === "j") div.classList.add("indicator");

    row.appendChild(div);
  });
}

createRow("topRow", topKeys);
createRow("homeRow", homeKeys);
createRow("bottomRow", bottomKeys);

let previousKey = null;

// Pick a random key, weighted toward common letters
function randomKey() {
  if(Math.random() < 0.4){
    return commonLetters[Math.floor(Math.random()*commonLetters.length)];
  }
  return allKeys[Math.floor(Math.random()*allKeys.length)];
}

// Show new letter
function showNewKey(key) {
  if(previousKey){
    const prevEl = document.getElementById(`vis-${previousKey}`);
    if(prevEl) prevEl.classList.remove("target");
  }

  currentBox.style.opacity = 0;
  setTimeout(() => {
    currentBox.textContent = key.toUpperCase();
    currentBox.style.opacity = 1;

    const el = document.getElementById(`vis-${key}`);
    if(el) el.classList.add("target");

    previousKey = key;
  },50);
}

// Flash key correct/wrong
function flashKeyVis(key, correct=true){
  const el = document.getElementById(`vis-${key}`);
  if(!el) return;
  el.classList.add("active");
  el.classList.add(correct ? "correct" : "wrong");
  setTimeout(() => {
    el.classList.remove("active", "correct", "wrong");
  },150);
}

// Start
let currentKey = randomKey();
showNewKey(currentKey);

document.addEventListener("keydown", e=>{
  const key = e.key.toLowerCase();
  if(!allKeys.includes(key)) return;

  statsData[key].total++;

  if(key === currentKey){
    statsData[key].correct++;
    flashKeyVis(key,true);
    currentKey = randomKey();
    showNewKey(currentKey);
  } else {
    flashKeyVis(key,false);
  }
});
</script>
</body>
</html>